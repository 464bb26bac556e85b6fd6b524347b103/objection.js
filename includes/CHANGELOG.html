<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Documentation</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_CHANGELOG">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="../images/logo.png" />
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="changelog">Changelog</h1>

<h2 id="0-7-4">0.7.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>automatically select columns needed for relations <a href="https://github.com/Vincit/objection.js/issues/309">#309</a></li>
<li>fix an issue where <code class="prettyprint">$formatJson</code> was called inside <code class="prettyprint">insertGraph</code> <a href="https://github.com/Vincit/objection.js/issues/326">#326</a></li>
</ul>

<h2 id="0-7-3">0.7.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix <a href="https://github.com/Vincit/objection.js/issues/325">#325</a></li>
<li>fix an issue where <code class="prettyprint">select</code> had to be used in addition to <code class="prettyprint">distinct</code> in some cases</li>
</ul>

<h2 id="0-7-2">0.7.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">HasOneThroughRelation</code> relation type.</li>
</ul>

<h2 id="0-7-1">0.7.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Fix <code class="prettyprint">JoinEagerAlgorithm</code> NPE bug</li>
</ul>

<h2 id="0-7-0">0.7.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">jsonSchema</code> without <code class="prettyprint">properties</code> now works. <a href="https://github.com/Vincit/objection.js/issues/205">#205</a></li>
<li><code class="prettyprint">relationMappings</code> can now be a function. <a href="https://github.com/Vincit/objection.js/issues/227">#227</a></li>
<li>many to many extras can now be aliased. <a href="https://github.com/Vincit/objection.js/issues/223">#223</a></li>
<li>zero values are now allowed in relation columns. <a href="https://github.com/Vincit/objection.js/issues/228">#228</a></li>
<li>active transaction can now be accessed in <code class="prettyprint">$before/$after</code> hooks through <code class="prettyprint">queryContext.transaction</code> property.</li>
<li>Validation can now be easily modified through a new <a href="#validator"><code class="prettyprint">Validator</code></a> interface. <a href="https://github.com/Vincit/objection.js/issues/241">#241</a> <a href="https://github.com/Vincit/objection.js/issues/199">#199</a></li>
<li>fix a <code class="prettyprint">JoinEager</code> problem where an empty result for a relation caused the following relations to be empty. <a href="https://github.com/Vincit/objection.js/issues/292">#292</a></li>
<li><code class="prettyprint">ref(fieldExpression)</code> syntax to reduce need for knex.raw and updating single attribute inside JSON column. <a href="https://github.com/Vincit/objection.js/issues/270">#270</a></li>
<li><a href="http://vincit.github.io/objection.js/#mergeeager">mergeEager</a> method.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><code class="prettyprint">$relatedQuery</code> now returns a single model instead of an array for belongsToOne and hasOne relations. <a href="https://github.com/Vincit/objection.js/issues/155">#155</a></li>
<li>identifier of a model can now be updated. Be careful with this one! Before if you forgot a wrong id in an <code class="prettyprint">update</code>/<code class="prettyprint">patch</code> operation, it would simply get ignored. Now the id is also updated just like any other column <a href="https://github.com/Vincit/objection.js/issues/100">#100</a></li>
<li><code class="prettyprint">Table.*</code> is now selected by default in all queries instead of <code class="prettyprint">*</code>. This will break some join queries that don&rsquo;t have an explicit select clause. <a href="https://github.com/Vincit/objection.js/issues/161">#161</a></li>
<li><code class="prettyprint">ValidationError.data</code> is now an object including, for each key, a list of errors with context info. <a href="https://github.com/Vincit/objection.js/issues/283">#283</a></li>
</ul>

<h2 id="0-6-2">0.6.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">relationMappings</code> can now be a function <a href="https://github.com/Vincit/objection.js/issues/227">#227</a></li>
</ul>

<h2 id="0-6-1">0.6.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix bug <a href="https://github.com/Vincit/objection.js/issues/205">#205</a></li>
</ul>

<h2 id="0-6-0">0.6.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Eager loading can now be done using joins and zero extra queries. See <a href="#eageralgorithm"><code class="prettyprint">eagerAlgorithm</code></a>, <a href="#defaulteageralgorithm"><code class="prettyprint">defaultEagerAlgorithm</code></a> and <a href="#eager"><code class="prettyprint">eager</code></a> for more info.</li>
<li><code class="prettyprint">#ref</code> in graph inserts can now contain extra properties for many-to-many relations <a href="https://github.com/Vincit/objection.js/issues/156">#156</a></li>
<li><code class="prettyprint">#dbRef</code> can now be used to refer to existing rows from a <code class="prettyprint">insertWithRelated</code> graph.</li>
<li><a href="#modelpaths"><code class="prettyprint">modelPaths</code></a> attribute for cleaner way to point to models in relationMappings.</li>
<li><a href="#pickjsonschemaproperties"><code class="prettyprint">pickJsonSchemaProperties</code></a> config parameter <a href="https://github.com/Vincit/objection.js/issues/110">#110</a></li>
<li><a href="#insertgraphandfetch"><code class="prettyprint">insertGraphAndFetch</code></a> with <code class="prettyprint">insertWithRelatedAndFetch</code> alias. <a href="https://github.com/Vincit/objection.js/issues/172">#172</a></li>
<li>Added <a href="#_s_beforedelete"><code class="prettyprint">$beforeDelete</code></a> and <a href="#_s_afterdelete"><code class="prettyprint">$afterDelete</code></a> hooks <a href="https://github.com/Vincit/objection.js/issues/112">#112</a></li>
<li>Old values can now be accessed from <code class="prettyprint">$beforeUpdate</code>, <code class="prettyprint">$afterUpdate</code>, <code class="prettyprint">$beforeValidate</code> and <code class="prettyprint">$afterValidate</code> hooks <a href="https://github.com/Vincit/objection.js/issues/185">#185</a></li>
<li>Support length property <a href="ttps://github.com/Vincit/objection.js/issues/168">#168</a></li>
<li>Make sure operations are executed in the order they are called <a href="https://github.com/Vincit/objection.js/issues/180">#180</a></li>
<li>Fetch nothing if the <code class="prettyprint">where</code> clauses hit no rows in <code class="prettyprint">update/patchAndFetchById</code> methods <a href="https://github.com/Vincit/objection.js/issues/189">#189</a></li>
<li>Lots of performance tweaks.</li>
<li><code class="prettyprint">$loadRelated</code> and <code class="prettyprint">loadRelated</code> now return a <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li><p>Undefined values as query method arguments now throw an exception. Before they were just silently ignored
and for example <code class="prettyprint">delete().where(&#39;id&#39;, undefined)</code> caused the entire table to be deleted. <a href="http://vincit.github.io/objection.js/#skipundefined">skipUndefined</a>
method can be called for a query builder to handle the undefined values the old way.</p></li>
<li><p>Deprecated method <code class="prettyprint">dumpSql</code> is now removed.</p></li>
<li><p><code class="prettyprint">$loadRelated</code> and <code class="prettyprint">loadRelated</code> now return a <code class="prettyprint">QueryBuilder</code>. This may break your code is some rare cases
where you have called a non-standard promise method like <code class="prettyprint">reflect</code> for the return value of these functions.</p></li>
</ul>

<h2 id="0-5-5">0.5.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#virtualattributes">Virtual attributes</a></li>
</ul>

<h2 id="0-5-4">0.5.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: insertWithRelated now works with <code class="prettyprint">additionalProperties = false</code> in <code class="prettyprint">jsonSchema</code></li>
<li>Add updateAndFetch and patchAndFetch methods for <code class="prettyprint">$query</code></li>
<li>bugfix: afterGet was not called for nested models in eager query</li>
<li>Use ajv instad of tv4 for json schema validation</li>
</ul>

<h2 id="0-5-3">0.5.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>ES6 promise compatibility fixes.</li>
</ul>

<h2 id="0-5-1">0.5.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#afterget">$afterGet</a> hook.</li>
</ul>

<h2 id="0-5-0">0.5.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="#joinrelation">joinRelation</a> family of query builder methods.</li>
<li><code class="prettyprint">HasOneRelation</code> for creating inverse one-to-one relations.</li>
<li>Relations have been renamed <code class="prettyprint">OneToOneRelation</code> &ndash;&gt; <code class="prettyprint">BelongsToOneRelation</code>, <code class="prettyprint">OneToManyRelation</code> &ndash;&gt; <code class="prettyprint">HasManyRelation</code>.
The old names work, but have been deprecated.</li>
<li><a href="#withschema">withSchema</a> now works as expected and sets the schema of all queries executed by the query builder the
method is called for.</li>
<li><a href="#filtereager">filterEager</a> method for better eager query filtering.</li>
<li><a href="#relationmappings">extra properties</a> feature for selecting/inserting columns from/to the join table in many-to-many relations.</li>
<li>Eager query recursion depth can be controlled like so: <code class="prettyprint">parent.^5</code>.</li>
</ul>

<h2 id="0-4-0">0.4.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Query context feature. See <a href="https://github.com/Vincit/objection.js/issues/51">#51</a> and <a href="#context">these docs</a> for more info.</li>
<li>Composite key support.</li>
<li><a href="#findbyid">findById</a>, <a href="#deletebyid">deleteById</a>, <a href="#wherecomposite">whereComposite</a> and
<a href="#whereincomposite">whereInComposite</a> query builder methods.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<p>There shouldn&rsquo;t be any major breaking changes. We moved from ES5 to ES7 + babel in this version so there are big changes
in the codebase. If something comes up, please open an issue.</p>

<p>There are a few known corner cases that may break:</p>

<ul>
<li><p>You can now define a model for the join table of <code class="prettyprint">ManyToMany</code> relations in <code class="prettyprint">relationMappings</code>. This is optional,
but may be needed if you already have a model for a <code class="prettyprint">ManyToMany</code> relation <em>and</em> you use <code class="prettyprint">snake_case</code>
to <code class="prettyprint">camelCase</code> conversion for the column names. See the documentation on the <a href="#relationthrough">through</a>
property of <a href="#relationmappings">relationMappings</a>.</p></li>
<li><p>The repo no longer contains the actual built javascript. Only the ES7 code that is transpiled when the code is
published to npm. Therefore you can no longer specify a git hash to package.json to use for example the
HEAD version. We will start to publish alpha and RC versions to npm when something new and experimental
is added to the library.</p></li>
</ul>

<h2 id="0-3-3">0.3.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>fix regression: QueryBuilder.from is broken.</li>
</ul>

<h2 id="0-3-2">0.3.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Improved relation expression whitespace handling.</li>
</ul>

<h2 id="0-3-1">0.3.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><code class="prettyprint">whereJson*</code> methods can now be used inside functions given to <code class="prettyprint">where</code> methods.</li>
<li>Added multiple missing knex methods to <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h2 id="0-3-0">0.3.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li><a href="http://vincit.github.io/objection.js/QueryBuilder.html#insertWithRelated">insertWithRelated</a> method for
inserting model trees</li>
<li><a href="http://vincit.github.io/objection.js/QueryBuilder.html#insertAndFetch">insertAndFetch</a>,
<a href="http://vincit.github.io/objection.js/QueryBuilder.html#updateAndFetchById">updateAndFetchById</a> and
<a href="http://vincit.github.io/objection.js/QueryBuilder.html#patchAndFetchById">patchAndFetchById</a> helper methods</li>
<li>Filters for <a href="#eager-queries">eager expressions</a></li>
<li><a href="#transaction-object">New alternative way to use transactions</a></li>
<li>Many performance updates related to cloning, serializing and deserializing model trees.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li>QueryBuilder methods <code class="prettyprint">update</code>, <code class="prettyprint">patch</code> and <code class="prettyprint">delete</code> now return the number of affected rows.
The new methods <code class="prettyprint">updateAndFetchById</code> and <code class="prettyprint">patchAndFetchById</code> may help with the migration</li>
<li><code class="prettyprint">modelInstance.$query()</code> instance method now returns a single model instead of an array</li>
<li>Removed <code class="prettyprint">Model.generateId()</code> method. <code class="prettyprint">$beforeInsert</code> can be used instead</li>
</ul>

<h2 id="0-2-8">0.2.8</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>ES6 inheritance support</li>
<li>generator function support for transactions</li>
<li>traverse,pick and omit methods for Model and QueryBuilder</li>
<li>bugfix: issue #38</li>
</ul>

<h2 id="0-2-7">0.2.7</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix #37 also for <code class="prettyprint">$query()</code>.</li>
<li>Significant <code class="prettyprint">toJson</code>/<code class="prettyprint">fromJson</code> performance boost.</li>
</ul>

<h2 id="0-2-6">0.2.6</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix regression bug that broke dumpSql.</li>
</ul>

<h2 id="0-2-5">0.2.5</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: fix regression bug that prevented values assigned to <code class="prettyprint">this</code> in <code class="prettyprint">$before</code> callbacks from getting into
the actual database query</li>
</ul>

<h2 id="0-2-4">0.2.4</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: many-to-many relations didn&rsquo;t work correctly with a snake_case to camelCase conversion
in the related model class.</li>
</ul>

<h2 id="0-2-3">0.2.3</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>Promise constructor is now exposed through <code class="prettyprint">require(&#39;objection&#39;).Promise</code>.</li>
</ul>

<h2 id="0-2-2">0.2.2</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>$beforeUpdate, $afterUpdate, $beforeInsert etc. are now asynchronous and you can return promises from them.</li>
<li>Added <code class="prettyprint">Model.fn()</code> shortcut to <code class="prettyprint">knex.fn</code>.</li>
<li>Added missing <code class="prettyprint">asCallback</code> and <code class="prettyprint">nodeify</code> methods for <code class="prettyprint">QueryBuilder</code>.</li>
</ul>

<h2 id="0-2-1">0.2.1</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>bugfix: Chaining <code class="prettyprint">insert</code> with <code class="prettyprint">returning</code> now returns all listed columns.</li>
</ul>

<h2 id="0-2-0">0.2.0</h2>

<h3 id="what-39-s-new">What&rsquo;s new</h3>

<ul>
<li>New name <code class="prettyprint">objection.js</code>.</li>
<li><code class="prettyprint">$beforeInsert</code>, <code class="prettyprint">$afterInsert</code>, <code class="prettyprint">$beforeUpdate</code> and <code class="prettyprint">$afterUpdate</code> hooks for <code class="prettyprint">Model</code>.</li>
<li>Postgres jsonb query methods: <code class="prettyprint">whereJsonEquals</code>, <code class="prettyprint">whereJsonSupersetOf</code>, <code class="prettyprint">whereJsonSubsetOf</code> and friends.</li>
<li><code class="prettyprint">whereRef</code> query method.</li>
<li>Expose <code class="prettyprint">knex.raw()</code> through <code class="prettyprint">Model.raw()</code>.</li>
<li>Expose <code class="prettyprint">knex.client.formatter()</code> through <code class="prettyprint">Model.formatter()</code>.</li>
<li><code class="prettyprint">QueryBuilder</code> can be used to make sub queries just like knex&rsquo;s <code class="prettyprint">QueryBuilder</code>.</li>
<li>Possibility to use a custom <code class="prettyprint">QueryBuilder</code> subclass by overriding <code class="prettyprint">Model.QueryBuilder</code>.</li>
<li>Filter queries/objects for relations.</li>
<li>A pile of bug fixes.</li>
</ul>

<h3 id="breaking-changes">Breaking changes</h3>

<ul>
<li>Project was renamed to objection.js. Migrate simply by replacing <code class="prettyprint">moron</code> with <code class="prettyprint">objection</code>.</li>
</ul>

<h2 id="0-1-0">0.1.0</h2>

<p>First release.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
